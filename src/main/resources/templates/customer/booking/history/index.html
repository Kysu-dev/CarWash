<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{customer/layout :: head}">
    <title>My Bookings - Sparkle AutoWash</title>
    <style>
        .booking-card {
            transition: all 0.3s ease;
        }
        .booking-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .status-badge {
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.375rem 0.75rem;
            border-radius: 9999px;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        .status-pending {
            background-color: #FEF3C7;
            color: #92400E;
        }
        
        .status-confirmed {
            background-color: #DBEAFE;
            color: #1E40AF;
        }
        
        .status-in-progress {
            background-color: #E0E7FF;
            color: #5B21B6;
        }
        
        .status-completed {
            background-color: #D1FAE5;
            color: #065F46;
        }
        
        .status-cancelled {
            background-color: #FEE2E2;
            color: #991B1B;
        }
        
        .filter-tag {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: 2px solid #E5E7EB;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .filter-tag.active {
            border-color: #3B82F6;
            background-color: #3B82F6;
            color: white;
        }
        
        .filter-tag:hover:not(.active) {
            border-color: #3B82F6;
            background-color: #EFF6FF;
        }

        .review-section {
            background: linear-gradient(135deg, #F3F4F6, #E5E7EB);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .star-rating {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 0.5rem;
        }

        .star {
            color: #D1D5DB;
            font-size: 1.25rem;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .star.active {
            color: #F59E0B;
        }

        .star:hover {
            color: #F59E0B;
        }
    </style>
</head>
<body>
    <div th:replace="~{customer/layout :: layout('My Bookings', ~{::section})}">
        <section>
            <div class="p-6 space-y-6">
                <!-- Header -->
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">My Bookings</h1>
                        <p class="text-gray-600 mt-1">Track and manage your car wash appointments</p>
                    </div>
                    <a th:href="@{/customer/booking}" 
                       class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>
                        New Booking
                    </a>
                </div>

                <!-- Filters -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                    <div class="flex flex-wrap gap-4 items-center">
                        <span class="text-sm font-medium text-gray-700">Filter by status:</span>
                        <div class="flex flex-wrap gap-2">
                            <div class="filter-tag active" data-status="all">
                                <span>All</span>
                                <span class="ml-1 text-xs opacity-75">(12)</span>
                            </div>
                            <div class="filter-tag" data-status="pending">
                                <span>Pending</span>
                                <span class="ml-1 text-xs opacity-75">(2)</span>
                            </div>
                            <div class="filter-tag" data-status="confirmed">
                                <span>Confirmed</span>
                                <span class="ml-1 text-xs opacity-75">(3)</span>
                            </div>
                            <div class="filter-tag" data-status="in-progress">
                                <span>In Progress</span>
                                <span class="ml-1 text-xs opacity-75">(1)</span>
                            </div>
                            <div class="filter-tag" data-status="completed">
                                <span>Completed</span>
                                <span class="ml-1 text-xs opacity-75">(5)</span>
                            </div>
                            <div class="filter-tag" data-status="cancelled">
                                <span>Cancelled</span>
                                <span class="ml-1 text-xs opacity-75">(1)</span>
                            </div>
                        </div>
                        
                        <div class="ml-auto flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <label class="text-sm font-medium text-gray-700">Date Range:</label>
                                <input type="date" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                                <span class="text-gray-500">to</span>
                                <input type="date" class="border border-gray-300 rounded-lg px-3 py-2 text-sm">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Booking Cards -->
                <div class="space-y-4" id="bookings-container">
                    <!-- Today's Appointment -->
                    <div class="booking-card bg-white rounded-xl shadow-sm border border-gray-100 p-6" data-status="confirmed">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="h-12 w-12 bg-blue-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-spray-can text-blue-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">Quick Wash</h3>
                                    <p class="text-gray-600 text-sm">Booking #BK2025060601</p>
                                </div>
                            </div>
                            <span class="status-badge status-confirmed">Confirmed</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Date</p>
                                    <p class="text-sm font-medium">Today, June 6</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-clock text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Time</p>
                                    <p class="text-sm font-medium">2:00 PM</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-car text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Vehicle</p>
                                    <p class="text-sm font-medium">Toyota Avanza</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-tag text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Price</p>
                                    <p class="text-sm font-medium">Rp 50,000</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                <div class="h-2 w-2 bg-green-500 rounded-full animate-pulse"></div>
                                <span class="text-sm text-green-600 font-medium">Arriving in 30 minutes</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="px-4 py-2 text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors text-sm">
                                    View Details
                                </button>
                                <button class="px-4 py-2 text-red-600 border border-red-600 rounded-lg hover:bg-red-50 transition-colors text-sm">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- In Progress Booking -->
                    <div class="booking-card bg-white rounded-xl shadow-sm border border-gray-100 p-6" data-status="in-progress">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="h-12 w-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-gem text-purple-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">Premium Wash</h3>
                                    <p class="text-gray-600 text-sm">Booking #BK2025060502</p>
                                </div>
                            </div>
                            <span class="status-badge status-in-progress">In Progress</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Date</p>
                                    <p class="text-sm font-medium">Today, June 6</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-clock text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Time</p>
                                    <p class="text-sm font-medium">10:00 AM</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-car text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Vehicle</p>
                                    <p class="text-sm font-medium">Honda Civic</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-tag text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Price</p>
                                    <p class="text-sm font-medium">Rp 75,000</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Live Progress -->
                        <div class="bg-purple-50 rounded-lg p-4 mb-4">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-sm font-medium text-purple-800">Service Progress</span>
                                <span class="text-sm text-purple-600">65% Complete</span>
                            </div>
                            <div class="w-full bg-purple-200 rounded-full h-2">
                                <div class="bg-purple-600 h-2 rounded-full transition-all duration-300" style="width: 65%"></div>
                            </div>
                            <p class="text-sm text-purple-700 mt-2">
                                <i class="fas fa-user mr-1"></i>
                                Worker: Ahmad (ID: EMP001) â€¢ Current step: Interior cleaning
                            </p>
                        </div>
                        
                        <div class="flex justify-between items-center pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                <div class="h-2 w-2 bg-purple-500 rounded-full animate-pulse"></div>
                                <span class="text-sm text-purple-600 font-medium">Est. completion: 10:45 AM</span>
                            </div>
                            <button class="px-4 py-2 text-purple-600 border border-purple-600 rounded-lg hover:bg-purple-50 transition-colors text-sm">
                                View Live Progress
                            </button>
                        </div>
                    </div>

                    <!-- Completed Booking with Review -->
                    <div class="booking-card bg-white rounded-xl shadow-sm border border-gray-100 p-6" data-status="completed">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-award text-green-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">Deep Clean</h3>
                                    <p class="text-gray-600 text-sm">Booking #BK2025060503</p>
                                </div>
                            </div>
                            <span class="status-badge status-completed">Completed</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Date</p>
                                    <p class="text-sm font-medium">June 5, 2025</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-clock text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Time</p>
                                    <p class="text-sm font-medium">9:00 AM</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-car text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Vehicle</p>
                                    <p class="text-sm font-medium">BMW X3</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-tag text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Price</p>
                                    <p class="text-sm font-medium">Rp 100,000</p>
                                </div>
                            </div>
                        </div>

                        <!-- Review Section -->
                        <div class="review-section">
                            <div class="flex justify-between items-start mb-3">
                                <h4 class="font-semibold text-gray-800">Your Review</h4>
                                <div class="flex items-center space-x-1">
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <i class="fas fa-star text-yellow-400"></i>
                                    <span class="text-sm text-gray-600 ml-2">5.0</span>
                                </div>
                            </div>
                            <p class="text-gray-700 text-sm mb-3">
                                "Excellent service! My car looks brand new. The team was professional and thorough. 
                                Definitely coming back for the next wash!"
                            </p>
                            <div class="flex justify-between items-center text-xs text-gray-500">
                                <span>Reviewed on June 5, 2025</span>
                                <button class="text-blue-600 hover:text-blue-700">Edit Review</button>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-check-circle text-green-600"></i>
                                <span class="text-sm text-green-600 font-medium">Service completed</span>
                            </div>
                            <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                Book Again
                            </button>
                        </div>
                    </div>

                    <!-- Pending Booking -->
                    <div class="booking-card bg-white rounded-xl shadow-sm border border-gray-100 p-6" data-status="pending">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="h-12 w-12 bg-orange-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-spray-can text-orange-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">Quick Wash</h3>
                                    <p class="text-gray-600 text-sm">Booking #BK2025060701</p>
                                </div>
                            </div>
                            <span class="status-badge status-pending">Pending</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Date</p>
                                    <p class="text-sm font-medium">June 7, 2025</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-clock text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Time</p>
                                    <p class="text-sm font-medium">3:00 PM</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-car text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Vehicle</p>
                                    <p class="text-sm font-medium">Suzuki Ertiga</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-tag text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Price</p>
                                    <p class="text-sm font-medium">Rp 50,000</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-orange-50 rounded-lg p-4 mb-4">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-info-circle text-orange-600"></i>
                                <p class="text-sm text-orange-800">
                                    <strong>Awaiting confirmation.</strong> We'll notify you once your booking is confirmed by our team.
                                </p>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-hourglass-half text-orange-600"></i>
                                <span class="text-sm text-orange-600 font-medium">Pending approval</span>
                            </div>
                            <div class="flex space-x-2">
                                <button class="px-4 py-2 text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors text-sm">
                                    Edit Booking
                                </button>
                                <button class="px-4 py-2 text-red-600 border border-red-600 rounded-lg hover:bg-red-50 transition-colors text-sm">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Completed Booking Without Review -->
                    <div class="booking-card bg-white rounded-xl shadow-sm border border-gray-100 p-6" data-status="completed">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center space-x-4">
                                <div class="h-12 w-12 bg-green-100 rounded-lg flex items-center justify-center">
                                    <i class="fas fa-gem text-green-600"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-semibold text-gray-800">Premium Wash</h3>
                                    <p class="text-gray-600 text-sm">Booking #BK2025060301</p>
                                </div>
                            </div>
                            <span class="status-badge status-completed">Completed</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-calendar text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Date</p>
                                    <p class="text-sm font-medium">June 3, 2025</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-clock text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Time</p>
                                    <p class="text-sm font-medium">11:00 AM</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-car text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Vehicle</p>
                                    <p class="text-sm font-medium">Toyota Camry</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-tag text-gray-400"></i>
                                <div>
                                    <p class="text-xs text-gray-500">Price</p>
                                    <p class="text-sm font-medium">Rp 75,000</p>
                                </div>
                            </div>
                        </div>

                        <!-- Add Review Section -->
                        <div class="review-section">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-semibold text-gray-800">Rate Your Experience</h4>
                                <button class="text-blue-600 text-sm hover:text-blue-700" onclick="toggleReviewForm(this)">
                                    Add Review
                                </button>
                            </div>
                            
                            <div class="review-form" style="display: none;">
                                <div class="star-rating mb-3">
                                    <i class="star fas fa-star" data-rating="1"></i>
                                    <i class="star fas fa-star" data-rating="2"></i>
                                    <i class="star fas fa-star" data-rating="3"></i>
                                    <i class="star fas fa-star" data-rating="4"></i>
                                    <i class="star fas fa-star" data-rating="5"></i>
                                </div>
                                <textarea placeholder="Share your experience with us..." 
                                          class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm mb-3 resize-none" 
                                          rows="3"></textarea>
                                <div class="flex space-x-2">
                                    <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                        Submit Review
                                    </button>
                                    <button class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm" 
                                            onclick="toggleReviewForm(this)">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center pt-4 border-t">
                            <div class="flex items-center space-x-2">
                                <i class="fas fa-check-circle text-green-600"></i>
                                <span class="text-sm text-green-600 font-medium">Service completed</span>
                            </div>
                            <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm">
                                Book Again
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Load More Button -->
                <div class="text-center">
                    <button class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                        Load More Bookings
                    </button>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Filter functionality
        document.addEventListener('DOMContentLoaded', function() {
            const filterTags = document.querySelectorAll('.filter-tag');
            const bookingCards = document.querySelectorAll('.booking-card');

            filterTags.forEach(tag => {
                tag.addEventListener('click', function() {
                    // Remove active class from all tags
                    filterTags.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked tag
                    this.classList.add('active');
                    
                    const status = this.dataset.status;
                    
                    // Filter booking cards
                    bookingCards.forEach(card => {
                        if (status === 'all' || card.dataset.status === status) {
                            card.style.display = 'block';
                        } else {
                            card.style.display = 'none';
                        }
                    });
                });
            });

            // Star rating functionality
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const rating = parseInt(this.dataset.rating);
                    const container = this.closest('.star-rating');
                    const containerStars = container.querySelectorAll('.star');
                    
                    containerStars.forEach((s, index) => {
                        if (index < rating) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });
        });

        function toggleReviewForm(button) {
            const reviewSection = button.closest('.review-section');
            const reviewForm = reviewSection.querySelector('.review-form');
            
            if (reviewForm.style.display === 'none') {
                reviewForm.style.display = 'block';
                button.textContent = 'Cancel';
            } else {
                reviewForm.style.display = 'none';
                button.textContent = 'Add Review';
            }
        }
    </script>

    <div th:replace="~{customer/layout :: scripts}"></div>
</body>
</html>
